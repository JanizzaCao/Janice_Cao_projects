1. 表user_goods_table: user_name 用户名，goods_kind 订购外卖品类  
   输出用户名，该用户购买最多的品类  
```
    SELECT user_name, goods_kind  
    FROM (SELECT user_name, goods_kind, RANK() OVER (  
          PARTITION BY user_name ORDER BY count(goods_kind)) AS rank  
          FROM user_goods_table)  
    WHERE rank = 1;   
```

2. 表user_sales_table: user_name用户名, pay_amount 用户支付额度  
    求用户支付金额在前20%的用户
```
    SELECT user_name 
    FROM (SELECT user_name, NTILE(5) OVER (
      ORDER BY SUM(pay_amount) DESC) as percent
      FROM user_sales_talbe
      GROUP BY user_name)
    WHERE percent = 1;
```

3. 表user_login_table: user_name用户名，date用户登录时间
    输出连续七天都登陆的用户名
```
    -- 假设每个用户每天只有一条登录记录
    SELECT user_name 
    FROM (SELECT user_name, date, LEAD(date, 7) 
       OVER(PARTITION BY user_name ORDER BY date) as seven_day
       FROM user_login_table)
    WHERE datediff(seven_day, date) = 7;
```
```
    --假设同上，筛选使用DATE_SUB; CAST()函数转换字符串为时间
    SELECT user_name 
    FROM (SELECT user_name, date, LEAD(date, 7) 
       OVER(PARTITION BY user_name ORDER BY date) as seven_day
       FROM user_login_table)
    WHERE DATE_SUB(CAST(seven_day AS date), INTERVAL 7 DAY)) = CAST(date AS date);
```

